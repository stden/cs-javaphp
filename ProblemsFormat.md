# Введение #

Задача для системы проведения удаленных олимпиад - это набор файлов, упакованных в ZIP архив вместе с файлом манифеста, описывающим содержимое архива. В общем случае задача может содержать следующие материалы:
  1. условие (на естественном языке)
  1. условие (формальное)
  1. ответ (на естественном языке)
  1. ответ (формальный)
  1. ссылка на модуль ввода ответа
  1. ссылка на модуль проверки решения
  1. другое (например, исходные данные)

# Манифест #
Все файлы являются данными, смысл которых понимает только соответствующий программный модуль. Единственным файлом, информацию в котором система понимает напрямую без посредства модулей - это манифест. В манифесте некоторым файлам архива назначены метки, также описано содержимое дополнительных файлов, которые по определенным причинам не лежат в архиве.

## Ресурсы ##
Задача является коллекцией ресурсов. Ресурсы - это все файлы архива, а также ресурсы могут быть описаны в файле манифеста.

Каждый ресурс имеет путь (path). Для файлов путь - это путь внутри архива, каталоги разделяет символ `/`. Например, ресурс `a.txt` - это файл, лежащий в корне архива, `folder/a.txt` - файл в каталоге `folder`.
Дополнительные ресурсы описываются тегами

```
<data path="...(путь)...">   (данные ресурса)   </data>
```

например, можно описать файл с ответом к задаче, которого нет в архиве. Считаем, что файла `answer.txt` нет в архиве, "создадим" этот файл, написав в нем 42:

```
<data path="answer.txt">42</data>
```

Вся информация о дополнительных ресурсах хранится в теге `resources`:

```
<resources>
    <data path="answer.txt">42</data>
    <data path="file.txt">239</data>
    ...
<resources>
```

## Метки ##
Чтобы система могла найти в архиве необходимые данные, некоторые ресурсы помечены метками, соответствующими смыслу ресурса (условие, формальное условие, ответ и т.п.) Метки могут соответствовать файлам или каталогам. Одной меткой можно пометить несколько ресурсов. Метка определяется тегом в `xml`. Например:

```
<statement-text path="statement.html" />
```

Здесь метка `statement-text` помечает файл `statement.html`. Ее смысл - "условие (на естественном языке)". Остальные метки:
  * `<statement>` формальное условие
  * `<answer-text>` ответ на естественном языке
  * `<answer>` формальный ответ.
  * `<input>` модуль ввода ответа
  * `<check>` модуль проверки решения
  * ... другие произвольные метки.

Если метка помечает каталог, то ресурсы внутри каталога считаются также помеченными этой меткой. Один ресурс может быть помечен несколькими метками.

Все метки собраны в тег `<labels>`:

```
<labels>
    <statement-text path="statement.html" />
    <answer path="answer.txt" />
    ...
</labels>
```

## Ресурсы, недоступные участнику ##
Некоторые данные не должны быть доступны участнику, потому что в них содержится ответ или информация, помогающая найти ответ. Доступность ресурса определяется его метками. В простейшей ситуции ресурс доступен, если он помечен одной из меток: `<statement>`, `<statement-text>`, `<input>`, `<check>`. Если ресурс помечен хотя бы одной меткой не из этого списка, он считается недоступным. Т.е. если пометить ресурс одновременно как `<statement>` и как `<answer>`, он не будет доступен участнику. Изменить это поведение можно с помощью дополнительной метки `<participant>`. Если ресурс помечен этой меткой, то он доступен независимо от других меток.
Все сказанное ранее про то, что метка на каталоге помечает каталог, работает и здесь. Например, метка `<participant>`, помечающая каталог, автоматически означает, что весь каталог обязан быть доступен участнику.

## Файла манифеста ##
Файл манифеста называется MANIFEST и лежит в корне архива. Он имеет основной тег `<problem-description>` и два подтега `<resources>` и `<labels>`

```
<problem-description>
    <resources>
        <data path="answer.txt">42</data>
        <data path="file.txt">239</data>
        ...
    <resources>
    <labels>
        <statement-text path="statement.html" />
        <answer path="answer.txt" />
        ...
    </labels>
</problem-description>
```

## Безымянные ресурсы ##

(этот раздел не обсуждался, описанные в нем возможности пока реализовывать не следует)

В некоторых случаях разделение записи о данных и их метки является лишним. Например, бессмысленно придумывать название файлу `answer.txt` только для того чтобы записать туда `42` и пометить его меткой `<answer>`. В этом случае можно использовать безымянные ресурсы, которые описаны в разделе ресурсов, но вместо пути к ним описана метка:

```
<problem-description>
    <resources>
        ...
        <data label="answer">42</data>        
        ...
    <resources>
    <labels>
        ...
        <!-- Здесь не описывается answer.txt -->
        ...
    </labels>
</problem-description>
```

Если путь к файлу все-таки описать нужно, он может быть указан вместе с меткой:

```
<problem-description>
    <resources>
        ...
        <data label="answer" path="answer1.txt">42</data>
        <data label="answer" path="answer2.txt">239</data>
        ...
    <resources>
    <labels>
        ...
        <!-- Здесь не описываются answer.txt -->
        ...
    </labels>
</problem-description>
```

Если в разделе `<resources>` ресурс необходимо пометить несколькими метками, они перечисляются через запятую в аргументе `label`. В разделе `<labels>` один ресурс можно помечать метками несколько раз.

## Интерфейс внешней программы ##
Программа, которая использует описанные подобным образом задачи, имеет к ним доступ на основе следующих методов
  * перечислить пути ресурсов с данной меткой
  * получить файл с данным путем
  * убрать из задачи все ресурсы, недоступные участнику
  * др. (раздел не дописан)