#summary Реализация плагина стороны клиента
#labels Phase-Implementation

= Реализация плагина стороны клиента =

Для разработки плагина необходимо подключить файл DCES_API.jar, содержащий в себе все нужные определения, и в частности описанные далее классы `Plugin` и `PluginEnvironment`.

Плагин - это jar файл, который содержит класс `ru.ipo.dces.Main`, реализующий интерфейс `Plugin`.

Конструктор плагина никогда не вызывается вручную, плагины создает DCES API своими средствами, при этом используется конструктор `Plugin(PluginEnvironment)`. Он должен быть определен.
Полученный в конструкторе объект класса PluginEnvironment следует сохранить, и пользоваться потом его методами по необходимости

Далее описан интерфейс `Plugin`
{{{
public interface Plugin {

  //плагин должен вернуть JPanel, на котором он рисуется
  public JPanel getPanel();

  //вызывается, когда пользователь переключается на плагин
  public void activate();

  //Вызывается, когда пользователь переключается с этого плагина на какой-то другой
  public void deactivate();

}
}}}

В интерфейсе `PluginEnvironment` есть следующие методы

{{{
public interface PluginEnvironment {     

  //Установить заголовок задачи. При обычной реализации системы проведения соревнований
  //заголовки задач располагаются на кнопках выбора задач
  public void setTitle(String title);

  //Посылка решения участника и получение ответа. Ответ и решение для максимального
  //обобщения имеют тип HashMap<String, String> (теоретически мог быть Object, но
  //такую общность реализовать не удалось). Плагины стороны клиента и сервера
  //сами определяют, что содержится в этих HashMap.
  //Метод бросает два исключения,
  //ServerReturnedError означает осмысленный ответ об  ошибке от сервера, например,
  //говорящий, что контест уже завершился и решения больше не принимаются.
  //Плагин должен отобразить пользоватею пришедшее сообщение об ошибке.
  //ServerReturnedNoAnswer означает, что сервер либо недоступен, либо вернул
  //бессмысленную информацию, в это случае надо сообщить пользователю "что-то не так, 
  //попробуйте еще".  
  public HashMap<String, String> submitSolution(HashMap<String, String> solution) throws ServerReturnedError, ServerReturnedNoAnswer;

  //Это каталог, в котором хранится условие задачи. Условие автоматически
  //загружается с сервера. Плагин сам ответственен за
  //содержимое этого каталога, и должен знать в каких файлах какую информацию искать.
  //Писать или читать что-то вне этого каталога крайне не рекомендуется
  public File getProblemFolder();

  //Каждая задача имеет имя, установленное при настройке контеста. Метод возвращает
  //имя задачи.
  public String getProblemName();

}
}}}

Средства для отладки плагина стороны клиента описаны в статье [ClientPluginDebug отладка плагина стороны клиента].